# Structure du texte du code
comment						[ \t]*#[^\n]*
blank						[ \t]+
newline						\n

# Mots clés de la directive .set
# version_pyvm				version_pyvm
# flags						flags
# filename					filename
# name						name
# source_size					source_size
# stack_size					stack_size
# arg_count					arg_count
# kwonly_arg_count			kwonly_arg_count
# posonly_arg_count			posonly_arg_count

# Instruction
insn                        STOP_CODE
insn                        POP_TOP
insn                        ROT_TWO
insn                        ROT_THREE
insn                        DUP_TOP
insn                        DUP_TOP_TWO
insn                        ROT_FOUR
insn                        NOP
insn                        UNARY_POSITIVE
insn                        UNARY_NEGATIVE
insn                        UNARY_NOT
insn                        UNARY_CONVERT
insn                        UNARY_INVERT
insn                        BINARY_POWER
insn                        BINARY_MULTIPLY
insn                        BINARY_DIVIDE
insn                        BINARY_MODULO
insn                        BINARY_ADD
insn                        BINARY_SUBTRACT
insn                        BINARY_SUBSCR
insn                        BINARY_FLOOR_DIVIDE
insn                        BINARY_TRUE_DIVIDE
insn                        INPLACE_FLOOR_DIVIDE
insn                        INPLACE_TRUE_DIVIDE
insn                        SLICE
insn                        SLICE_PLUS_1
insn                        SLICE_PLUS_2
insn                        SLICE_PLUS_3
insn                        STORE_SLICE
insn                        STORE_SLICE_PLUS_1
insn                        STORE_SLICE_PLUS_2
insn                        STORE_SLICE_PLUS_3
insn                        DELETE_SLICE
insn                        DELETE_SLICE_PLUS_1
insn                        DELETE_SLICE_PLUS_2
insn                        DELETE_SLICE_PLUS_3
insn                        GET_AITER
insn                        GET_ANEXT
insn                        BEFORE_ASYNC_WITH
insn                        BEGIN_FINALLY
insn                        END_ASYNC_FOR
insn                        GET_YIELD_FROM_ITER
insn                        LOAD_BUILD_CLASS
insn                        YIELD_FROM
insn                        GET_AWAITABLE
insn                        WITH_CLEANUP_START
insn                        WITH_CLEANUP_FINISH
insn                        SETUP_ANNOTATIONS
insn                        POP_EXCEPT
insn                        UNPACK_EX
insn                        DELETE_DEREF
insn                        CALL_FUNCTION_EX
insn                        LIST_APPEND
insn                        LOAD_CLASSDEREF
insn                        BUILD_LIST_UNPACK
insn                        BUILD_MAP_UNPACK
insn                        BUILD_MAP_UNPACK_WITH_CALL
insn                        BUILD_TUPLE_UNPACK
insn                        BUILD_SET_UNPACK
insn                        SETUP_ASYNC_WITH
insn                        FORMAT_VALUE
insn                        BUILD_CONST_KEY_MAP
insn                        BUILD_STRING
insn                        BUILD_TUPLE_UNPACK_WITH_CALL
insn                        LOAD_METHOD
insn                        CALL_METHOD
insn                        CALL_FINALLY
insn                        POP_FINALLY
insn                        STORE_MAP
insn                        INPLACE_ADD
insn                        INPLACE_SUBTRACT
insn                        INPLACE_MULTIPLY
insn                        INPLACE_DIVIDE
insn                        INPLACE_MODULO
insn                        STORE_SUBSCR
insn                        DELETE_SUBSCR
insn                        BINARY_LSHIFT
insn                        BINARY_RSHIFT
insn                        BINARY_AND
insn                        BINARY_XOR
insn                        BINARY_OR
insn                        INPLACE_POWER
insn                        GET_ITER
insn                        PRINT_EXPR
insn                        PRINT_ITEM
insn                        PRINT_NEWLINE
insn                        PRINT_ITEM_TO
insn                        PRINT_NEWLINE_TO
insn                        INPLACE_LSFHIT
insn                        INPLACE_RSHIFT
insn                        INPLACE_AND
insn                        INPLACE_XOR
insn                        INPLACE_OR
insn                        BREAK_LOOP
insn                        WITH_CLEANUPS
insn                        LOAD_LOCALS
insn                        RETURN_VALUE
insn                        IMPORT_STAR
insn                        EXEC_STMT
insn                        YIELD_VALUE
insn                        POP_BLOCK
insn                        END_FINALLY
insn                        BUILD_CLASS
insn                        STORE_NAME
insn                        DELETE_NAME
insn                        UNPACK_SEQUENCE
insn                        FOR_ITER
insn                        LIST_APPEND
insn                        STORE_ATTR
insn                        DELETE_ATTR
insn                        STORE_GLOBAL
insn                        DELETE_GLOBAL
insn                        DUP_TOPX
insn                        LOAD_CONST
insn                        LOAD_NAME
insn                        BUILD_TUPLE
insn                        BUILD_LIST
insn                        BUILD_SET
insn                        BUILD_MAP
insn                        LOAD_ATTR
insn                        COMPARE_OP
insn                        IMPORT_NAME
insn                        IMPORT_FROM
insn                        JUMP_FORWARD
insn                        JUMP_IF_FALSE_OR_POP
insn                        JUMP_IF_TRUE_OR_POP
insn                        JUMP_ABSOLUTE
insn                        POP_JUMP_IF_FALSE
insn                        POP_JUMP_IF_TRUE
insn                        LOAD_GLOBAL
insn                        CONTINUE_LOOP
insn                        SETUP_LOOP
insn                        SETUP_EXCEPT
insn                        SETUP_FINALLY
insn                        LOAD_FAST
insn                        STORE_FAST
insn                        DELETE_FAST
insn                        RAISE_VARARGS
insn                        CALL_FUNCTION
insn                        MAKE_FUNCTION
insn                        BUILD_SLICE
insn                        MAKE_CLOSURE
insn                        LOAD_CLOSURE
insn                        LOAD_DEREF
insn                        STORE_DEREF
insn                        CALL_FUNCTION_VAR
insn                        CALL_FUNCTION_KW
insn                        CALL_FUNCTION_VAR_KW
insn                        SETUP_WITH
insn                        EXTENDED_ARG
insn                        SET_ADD
insn                        MAP_ADD

# Description des constantes
# num::float::clpx            [\-+]?[0-9]+\.?[0-9]*[eE][\-+]?[0-9]+[+-][\-+]?[0-9]+\.?[0-9]*[eE][\-+]?[0-9]+j
# num::float::clpx            [\-+]?[0-9]+\.[0-9]*[+-][\-+]?[0-9]+\.?[0-9]*[eE][\-+]?[0-9]+j
# num::float::clpx            [\-+]?[0-9]+\.?[0-9]*[eE][\-+]?[0-9]+[+-][\-+]?[0-9]+\.[0-9]*j
num::cplx                   [\-+]?[0-9]+e[0-9]+[\-+][0-9]+e[0-9]+j
num::cplx                   [\-+]?[0-9]+\.[0-9]*[\-+][0-9]+\.[0-9]*j
num::cplx                   [\-+]?[0-9]+[\-+][0-9]+j
num::cplx                   [\-+]?[0-9]+j
num::float  				[\-+]?[0-9]+\.[0-9]*[eE]?[\-+]?[0-9]*
# num::float					[\-+]?[0-9]+\.[0-9]*
num::hex			    	0x[0-9A-Za-z]+
num::dec    				[\-+]?[0-9]+
string::dquote				"[ !#-~\t]*"
key::cst::none				None
key::cst::true				True
key::cst::false				False
key::cst::null				Null
#identifier					[a-zA-Z_][a-zA-Z_0-9]*
label                       [a-zA-Z_][a-zA-Z_0-9]*[ \t]*:
name						[a-zA-Z_][a-zA-Z_0-9]*
#symbol						[\n\t ]?[a-zA-Z_][a-zA-Z_0-9]*

# Opérateurs arithmétiques
# op::sum::plus				\+
# op::sum::minus				-
# op::prod::mul				\*
# op::prod::div				/

# Parenthèses, crochets et deux points
lparen  					(
rparen      				)
lbracket					\[
rbracket	    			]
colon                       :

# Directives python
key::dir::foo				\.foo
key::dir::set				\.set
key::dir::interned			\.interned
key::dir::constants			\.consts
key::dir::names				\.names
key::dir::varnames          \.varnames
key::dir::text				\.text
key::dir::line				\.line
key::dir::freevars          \.freevars
key::dir::cellvars          \.cellvars
key::dir::code::start       \.code_start
key::dir::code::end         \.code_end
# Autre directive inconnue
dir::other					\.[_a-z]+